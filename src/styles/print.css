/* Estilos específicos para impressão e geração de PDF */
@media print, screen {
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Container principal com altura protegida */
  .proposal-container {
    width: 210mm !important;
    margin: 0 auto !important;
    background: white !important;
    font-size: 12px !important;
    line-height: 1.4 !important;
    min-height: 280mm !important;
    position: relative !important;
  }

  /* Margens adequadas para A4 com proteção extra */
  .print-margin {
    margin: 10mm 15mm !important;
    padding: 0 10px !important;
    min-height: 250mm !important;
  }

  /* Quebras de página controladas */
  .page-break {
    page-break-before: always !important;
    break-before: page !important;
  }

  .page-break-after {
    page-break-after: always !important;
    break-after: page !important;
  }

  .no-page-break {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  .no-page-break-before {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  /* Header sempre junto */
  .header-section {
    position: relative;
    margin-bottom: 20px !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Seções que devem ficar juntas - proteção extra */
  .section-together {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    margin-bottom: 15px !important;
    padding: 5px !important;
    position: relative !important;
  }
  
  /* Proteção para título + conteúdo */
  .section-together h2 + div,
  .section-together h2 + .bg-gradient-to-r {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  /* Tabelas com proteção extra */
  .investment-table {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-before: avoid !important;
    break-before: avoid !important;
    width: 100% !important;
    border-collapse: collapse !important;
    margin-bottom: 15px !important;
  }

  .investment-table th,
  .investment-table td {
    padding: 8px 12px !important;
    border: 1px solid #e2e8f0 !important;
    text-align: left !important;
  }

  .investment-table th {
    background-color: #f1f5f9 !important;
    font-weight: bold !important;
  }

  /* Seção de investimento - evitar quebra inadequada */
  .investment-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    margin-top: 15px !important;
    padding-top: 0 !important;
  }

  /* Estrutura modular das páginas */
  .page-content-group {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    margin-bottom: 2rem !important;
  }

  .proposal-page-1 {
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  .proposal-page-2 {
    page-break-before: auto !important;
    break-before: auto !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  .proposal-page-3 {
    page-break-before: auto !important;
    break-before: auto !important;
  }

  /* Seções sempre juntas */
  .section-together {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
    margin-bottom: 1.5rem !important;
  }

  .section-together + .section-together {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  /* Tabelas de investimento protegidas */
  .investment-table-container {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    margin: 1rem 0 !important;
  }

  .investment-table-container table {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Condições comerciais sempre juntas */
  .commercial-conditions-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  /* Footer sempre protegido */
  .footer-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-before: avoid !important;
    break-before: avoid !important;
    margin-top: 20px !important;
    border-top: 1px solid #e2e8f0 !important;
    padding-top: 15px !important;
    min-height: 120px !important;
  }

  /* Seção de assinaturas - manter junto com footer */
  .signature-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
    margin-bottom: 10px !important;
  }

  /* Grupo de assinatura + footer como bloco único */
  .signature-section + .footer-section {
    page-break-before: avoid !important;
    break-before: avoid !important;
    margin-top: 10px !important;
  }

  /* Seção de resumo do pacote - evitar quebra entre título e conteúdo */
  .package-summary-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  .package-summary-section h2 {
    page-break-after: avoid !important;
    break-after: avoid !important;
    margin-bottom: 0.5rem !important;
  }

  .no-page-break-before {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  .no-page-break-after {
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  /* Ajustes específicos para impressão */
  .print-adjust {
    font-size: 11px !important;
    line-height: 1.3 !important;
  }

  /* Remove sombras e efeitos visuais */
  .print-clean {
    box-shadow: none !important;
    border-radius: 4px !important;
  }

  /* Espaçamentos reduzidos para impressão */
  .print-compact {
    padding: 10px 15px !important;
    margin: 10px 0 !important;
  }

  /* Títulos de seção */
  .section-title {
    page-break-after: avoid !important;
    break-after: avoid !important;
    margin-bottom: 8px !important;
    font-weight: bold !important;
    color: #374151 !important;
  }

  /* Cores forçadas para impressão */
  .force-print-colors {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}

/* Estilos específicos apenas para HTML2Canvas/PDF */
@media screen {
  .pdf-generation {
    width: 794px !important; /* A4 width in pixels at 96 DPI */
    background: white !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }

  .pdf-generation * {
    box-sizing: border-box !important;
  }

  /* Força as cores em todas as situações */
  .pdf-generation .force-print-colors,
  .pdf-generation .bg-gradient-to-r {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}

/* ========== REGRAS ADAPTATIVAS POR RESOLUÇÃO ========== */

/* Classes adaptativas por resolução */
.adaptive-resolution {
  --base-font-size: 12px;
  --base-padding: 8px;
  --base-margin: 10px;
  font-size: var(--base-font-size);
}

.high-dpi {
  --scale-factor: 1.5;
  --base-font-size: 11px;
  --base-padding: 6px;
  --base-margin: 8px;
}

.high-dpi .investment-table th,
.high-dpi .investment-table td {
  padding: calc(var(--base-padding) * 0.8) calc(var(--base-padding) * 1.2) !important;
  font-size: calc(var(--base-font-size) * 0.9) !important;
}

.screen-mobile {
  --base-font-size: 10px;
  --base-padding: 4px;
}

.screen-tablet {
  --base-font-size: 11px;
  --base-padding: 6px;
}

.screen-desktop {
  --base-font-size: 12px;
  --base-padding: 8px;
}

.screen-large-desktop {
  --base-font-size: 13px;
  --base-padding: 10px;
}

/* Proteção extra para DPR específicos */
.dpr-2 .section-together {
  padding: calc(var(--base-padding) * 1.1) !important;
  margin-bottom: calc(var(--base-margin) * 1.1) !important;
}

.dpr-3 .section-together,
.dpr-4 .section-together {
  padding: calc(var(--base-padding) * 1.5) !important;
  margin-bottom: calc(var(--base-margin) * 1.2) !important;
}

/* Ajustes para resoluções específicas */
@media screen and (min-resolution: 192dpi) {
  .adaptive-resolution {
    font-size: 11px !important;
    line-height: 1.3 !important;
  }
  
  .investment-table th,
  .investment-table td {
    padding: 6px 8px !important;
    font-size: 10px !important;
  }
}

@media screen and (min-resolution: 288dpi) {
  .adaptive-resolution {
    font-size: 10px !important;
    line-height: 1.2 !important;
  }
  
  .investment-table th,
  .investment-table td {
    padding: 4px 6px !important;
    font-size: 9px !important;
  }
}

/* Ajustes específicos para diferentes tamanhos de tela */
@media screen and (max-width: 768px) {
  .adaptive-resolution {
    --base-font-size: 10px;
    --base-padding: 4px;
    --base-margin: 6px;
  }
}

@media screen and (min-width: 1920px) {
  .adaptive-resolution:not(.high-dpi) {
    --base-font-size: 13px;
    --base-padding: 10px;
    --base-margin: 12px;
  }
}

/* Proteção contra quebras em dispositivos com alto DPI */
.high-dpi .section-together {
  page-break-inside: avoid !important;
  break-inside: avoid !important;
  margin-bottom: calc(var(--base-margin) * 1.5) !important;
}

/* Ajustes para escalamento em PDF */
@media print {
  .adaptive-resolution {
    transform-origin: top left !important;
  }
  
  .high-dpi {
    transform: scale(0.8) !important;
  }
  
  .dpr-3,
  .dpr-4 {
    transform: scale(0.75) !important;
  }
}